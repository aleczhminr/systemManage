@{
    ViewBag.Title = "通道设置";
}

<link type="text/css" rel="stylesheet" href="~/Scripts/plugins/qtip2/jquery.qtip.min.css" />
<style type="text/css">
    body {
        margin-top: 10px;
    }

    .overZone {
        display: none;
        width: 100%;
        height: 700px;
        opacity: 0.5;
        filter: alpha(opacity=40);
        background: white;
        position: absolute;
        top: 60px;
        z-index: 2000;
    }

    .progressBar {
        display: none;
        position: absolute;
        z-index: 2001;
        top: 40%;
        left: 40%;
        width: 150px;
        height: 35px;
        line-height: 35px;
        border: 1px solid #666;
        padding: 5px;
        text-align: center;
        color: #666;
        background-color: white;
        font-size: 12px;
    }

        .progressBar .close {
            margin: 8px 10px 0 0;
        }

    .smsChannel {
        float: left;
        width: 380px;
        height: 400px;
    }

        .smsChannel .alert {
            padding: 8px 14px 8px 14px;
        }

            .smsChannel .alert .sms-title {
                position: relative;
            }

                .smsChannel .alert .sms-title strong {
                    cursor: help;
                }

            .smsChannel .alert .s-val {
                position: absolute;
                right: 0px;
            }

                .smsChannel .alert .s-val .s-cname {
                    font-weight: bold;
                    color: #F50;
                }

                .smsChannel .alert .s-val a {
                    margin-left: 10px;
                    color: #AAA;
                    text-shadow: none;
                    font-size: 12px;
                }

            .smsChannel .alert .s-detail {
                border-top: 1px solid #ccc;
                margin-top: 5px;
                padding: 10px 0;
            }

        .smsChannel .smsFlagName {
            height: 25px;
            line-height: 25px;
            display: inline-block;
            background-color: #DFF0D8;
            border: 1px #D6E9C6 solid;
            padding: 0px 8px;
            border-radius: 3px;
            margin-left: 5px;
        }

    #channelInfo {
        float: left;
        width: 540px;
        min-height:500px;
    }

    #channelInfo .thumbnails .thumbnail {
        height: 30px;
        line-height: 30px;
        padding: 0px 8px;
    }

    #channelInfo .thumbnails li {
        height: 30px;
        line-height: 30px;
        list-style:none;
        margin-bottom:15px;
    }

        #channelInfo .thumbnails li a {
            padding: 0px;
            text-align: center;
            height: 30px;
            line-height: 30px;
            color: #468847;
        }

        #channelInfo .thumbnails li .title {
            font-weight: bold;
            color: #468847;
        }

        #channelInfo .thumbnails li .item {
            margin-left: 15px;
            color: #666;
        }

        #channelInfo .thumbnails li .number, .balance {
            font-weight: bold;
            color: #F50;
        }

    .priority-1 {
        height: 18px;
        line-height: 18px;
        display: inline-block;
        background-color: #C9C7FF;
        border: 1px #B9B7FD solid;
        padding: 0px 4px;
        border-radius: 3px;
        margin-left: 5px;
    }

    .priority0 {
        height: 18px;
        line-height: 18px;
        display: inline-block;
        background-color: #D9EDF7;
        border: 1px #BCE8F1 solid;
        padding: 0px 4px;
        border-radius: 3px;
        margin-left: 5px;
    }

    .priority1 {
        height: 18px;
        line-height: 18px;
        display: inline-block;
        background-color: #DFF0D8;
        border: 1px #D6E9C6 solid;
        padding: 0px 4px;
        border-radius: 3px;
        margin-left: 5px;
    }

    .priority2 {
        height: 18px;
        line-height: 18px;
        display: inline-block;
        background-color: #FCF8E3;
        border: 1px #FBEED5 solid;
        padding: 0px 4px;
        border-radius: 3px;
        margin-left: 5px;
    }

    .smsStatus0 {
        color: teal;
    }

    .smsStatus1 {
        color: #468847;
    }

    .smsStatus2 {
        color: #08C;
    }

    .smsStatus3 {
        color: #B94A48;
    }

    .span7 {
        width: 540px;
    }

    .qtip {
        max-width: inherit;
        line-height: 18px;
    }

    .StatusTitle {
        text-align: center;
        height: 30px;
        background-color: #EEE9FD;
        border: 1px solid #BFB3FD;
        line-height: 30px;
        margin: 0 0 20px 0;
    }
        .StatusTitle span {
            color: red;
            font-weight: bold;
        }
    .status-item {
        height: 130px;
    }
        .status-item .sms-title strong {
            cursor: help;
        }
        .status-item .s-detail {
            height: 60px;
        }
            .status-item .s-detail .s-channel {
                height: 25px;
            }
                .status-item .s-detail .s-channel .s-channelName {
                    float: left;
                    margin-right: 5px;
                }
                .status-item .s-detail .s-channel .progress {
                    float: left;
                    width: 160px;
                    margin-bottom: 0px;
                    height: 20px;
                    background-color: #f5f5f5;
                    box-shadow: inset 0 1px 2px rgba(0,0,0,.1);
                    border-radius: 0;
                }
</style>

<div>
    <div class="smsChannel">
        <!-- Template Zone-->
    </div>
    <div id="channelInfo" class="span7">
        <ul class="thumbnails">
            <li class="span7" style="display:none;">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,10)" title="点击查询通道详情">
                    [ 亿美系统 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">亿美系统</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_10" class="balance">?</span> 条</span><span class="item">特服号码：574173</span></span>
            </li>
            <li class="span7" style="display:none;">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,11)" title="点击查询通道详情">
                    [ 亿美快速 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">亿美快速</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_11" class="balance">?</span> 条</span><span class="item">特服号码：003000</span></span>
            </li>
            <li class="span7" style="display:none;">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,12)" title="点击查询通道详情">
                    [ 亿美广告 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">亿美广告</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_12" class="balance">?</span> 条</span><span class="item">特服号码：026485</span></span>
            </li>
            <li class="span7" style="display:none;">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,21)" title="点击查询通道详情">
                    [ 华兴快速 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">华兴快速</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_21" class="balance">?</span> 条</span><span class="item">特服号码：021835</span></span>
            </li>
            <li class="span7" style="display:none;">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,22)" title="点击查询通道详情">
                    [ 华兴广告 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">华兴广告</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_22" class="balance">?</span> 条</span><span class="item">特服号码：740725</span></span>
            </li>
            <li class="span7">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,31)" title="点击查询通道详情">
                    [ 电信通道 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">电信通道</span><span class="item">累计发送：<span class="number">0</span> 条</span></span>
            </li>
            <li class="span7" style="display:none;">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,41)" title="点击查询通道详情">
                    [ 维拓1069 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">维拓1069</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_41" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7" style="display:none;">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,42)" title="点击查询通道详情">
                    [ 维拓广告 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">维拓广告</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_42" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7" style="display:none;">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,51)" title="点击查询通道详情">
                    [ 北程系统 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">北程系统</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_51" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,60)" title="点击查询通道详情">
                    [ 助通系统_移动 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">助通系统_移动</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_60" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,61)" title="点击查询通道详情">
                    [ 助通系统 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">助通系统</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_61" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,62)" title="点击查询通道详情">
                    [ 助通快速 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">助通快速</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_62" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,63)" title="点击查询通道详情">
                    [ 助通广告 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">助通广告</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_63" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,64)" title="点击查询通道详情">
                    [ 助通后台自用 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">助通后台自用</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_64" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,65)" title="点击查询通道详情">
                    [ 助通通知 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">助通通知</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_65" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7" style="display:none;">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,70)" title="点击查询通道详情">
                    [ 云信高速触发 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">云信高速触发</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_70" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7" style="display:none;">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,71)" title="点击查询通道详情">
                    [ 云信备案通知 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">云信备案通知</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_71" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7" style="display:none;">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,72)" title="点击查询通道详情">
                    [ 云信综合营销 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">云信综合营销</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_72" class="balance">?</span> 条 【余额与 云信备案通知 共享】</span><span class="item"> </span></span>
            </li>
            <li class="span7" style="display:none;">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,73)" title="点击查询通道详情">
                    [ 云信测试通道 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">云信测试通道</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_73" class="balance">?</span> 条 【余额与 云信备案通知 共享】</span><span class="item"> </span></span>
            </li>
            <li class="span7">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,80)" title="点击查询通道详情">
                    [ 客通系统 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">客通系统</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_80" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,81)" title="点击查询通道详情">
                    [ 客通快速 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">客通快速</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_81" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,82)" title="点击查询通道详情">
                    [ 客通营销 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">客通营销</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_82" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7" style="display:none">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,92)" title="点击查询通道详情">
                    [ 九象广告 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">九象广告</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_92" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,100)" title="点击查询通道详情">
                    [ 云片系统 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">云片系统</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_100" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
            <li class="span7">
                <a href="javascript:void()" class="thumbnail" onclick="getChannelInfo(this,112)" title="点击查询通道详情">
                    [ 火尼营销 ]
                </a>
                <span class="thumbnail" style="display:none;"><span class="title">火尼营销</span><span class="item">累计发送：<span class="number">0</span> 条</span><span class="item">当前余额：<span id="balance_112" class="balance">?</span> 条</span><span class="item"> </span></span>
            </li>
        </ul>
    </div>

    <div id="ChannelSwitchList">
        <!--  Sms Channel List  -->
    </div>
</div>

<script type="text/html" id="ChannelSwitchList_Tpl">
    <table id="ChannelList" style="display:none;text-align:center;" rel="">
        <tr><td style="text-align:center;">- 选择通道 -</td></tr>
        {{each Channel}}
        <tr><td><a href='javascript:void(0)' onclick='ChannelSW(this)' rel='{{$value.ChannelId}}'>{{$value.ChannelName}}</a></td></tr>
        {{/each}}
    </table>
</script>

<script id="smsOptionOne-Tpl" type="text/html">
    <div style="text-align: center;height: 30px;background-color: #EEE9FD;border: 1px solid #BFB3FD;line-height: 30px;margin: 0 0 20px 0;">短信发送模式：<span style="color: red;font-weight: bold;" id="smsSendMode" rel="{SendMode}">通道绑定</span></div>
    <div class="alert alert-info">
        <div class="sms-title">
            <strong style="cursor: help;" title="系统验证码、店铺注册、密码找回">系统队列</strong><span class="s-val">当前：[ <span id="sys-name" class="s-cname">{SmsPriority.SysPriority.ChannelName}</span> ]<a class="menu" rel="sys_id" href="javascript:void(0)">切换</a></span>
        </div>
        <div class="s-detail">
            <div class="progress progress-info" style="margin-bottom: 0px;">
                <div id="sys_id" rel="{SmsPriority.SysPriority.ChannelId}" class="bar" style="width: 0%;cursor:help;"></div>
            </div>
        </div>
    </div>
    <div class="alert alert-success">
        <div class="sms-title">
            <strong style="cursor: help;" title="单条短信发送、会员注册、电子账单、生日提醒">普通队列</strong><span class="s-val">当前：[ <span id="fast-name" class="s-cname">{SmsPriority.FastPriority.ChannelName}</span> ]<a class="menu" rel="fast_id" href="javascript:void(0)">切换</a></span>
        </div>
        <div class="s-detail">
            <div class="progress progress-success" style="margin-bottom: 0px;">
                <div id="fast_id" rel="{SmsPriority.FastPriority.ChannelId}" class="bar" style="width: 0%;cursor:help;"></div>
            </div>
        </div>
    </div>
    <div class="alert alert-block">
        <div class="sms-title">
            <strong style="cursor: help;" title="短信群发通道（大于10条）">群发队列</strong><span class="s-val">当前：[ <span id="slow-name" class="s-cname">{SmsPriority.GroupPriority.ChannelName}</span> ]<a class="menu" rel="slow_id" href="javascript:void(0)">切换</a></span>
        </div>
        <div class="s-detail">
            <div class="progress progress-warning" style="margin-bottom: 0px;">
                <div id="slow_id" rel="{SmsPriority.GroupPriority.ChannelId}" class="bar" style="width: 0%;cursor:help;"></div>
            </div>
        </div>
    </div>
</script>


<script id="smsOptionTwo-Tpl" type="text/html">
    <div class="StatusTitle">短信发送模式：<span id="smsSendMode" rel="{{SendMode}}">运营商绑定</span></div>
    <div class="alert alert-info status-item">
        <div class="sms-title">
            <strong title="系统验证码、店铺注册、密码找回">系统队列</strong>
        </div>
        <div class="s-detail">
            <div class="s-channel">
                <span class="s-channelName" >移动：[ <span id="sys_mobile" style="color:#F50;">{{SmsOperator.SmsSystem.ChinaMobile.ChannelName}}</span> ]</span>
                <div class="progress">
                    <div id="sys_mobile_id" rel="{{SmsOperator.SmsSystem.ChinaMobile.ChannelId}}" class="progress-bar progress-bar-complete" role="progressbar" style="width: 0%;cursor:help;"></div>
                </div>
                <a class="menu" rel="sys_mobile" href="javascript:void(0)" style="float: left;margin-left: 10px;">切换</a>
            </div>
            <div class="s-channel">
                <span class="s-channelName">联通：[ <span id="sys_unicom" style="color:#F50;">{{SmsOperator.SmsSystem.ChinaUnicom.ChannelName}}</span> ]</span>
                <div class="progress">
                    <div id="sys_unicom_id" rel="{{SmsOperator.SmsSystem.ChinaUnicom.ChannelId}}" class="progress-bar progress-bar-complete" role="progressbar" style="width: 0%;cursor:help;"></div>
                </div>
                <a class="menu" rel="sys_unicom" href="javascript:void(0)" style="float: left;margin-left: 10px;">切换</a>
            </div>
            <div class="s-channel">
                <span class="s-channelName">电信：[ <span id="sys_telecom" style="color:#F50;">{{SmsOperator.SmsSystem.ChinaTelecom.ChannelName}}</span> ]</span>
                <div class="progress">
                    <div id="sys_telecom_id" rel="{{SmsOperator.SmsSystem.ChinaTelecom.ChannelId}}" class="progress-bar progress-bar-complete" role="progressbar" style="width: 0%;cursor:help;"></div>
                </div>
                <a class="menu" rel="sys_telecom" href="javascript:void(0)" style="float: left;margin-left: 10px;">切换</a>
            </div>
        </div>
    </div>
    <div class="alert alert-success status-item">
        <div class="sms-title">
            <strong style="cursor: help;" title="单条短信发送、会员注册、电子账单、生日提醒">普通队列</strong>
        </div>
        <div class="s-detail">
            <div class="s-channel">
                <span class="s-channelName">移动：[ <span id="fast_mobile" style="color:#F50;">{{SmsOperator.SmsFast.ChinaMobile.ChannelName}}</span> ]</span>
                <div class="progress">
                    <div id="fast_mobile_id" rel="{{SmsOperator.SmsFast.ChinaMobile.ChannelId}}" class="progress-bar progress-bar-success" role="progressbar" style="width: 0%;cursor:help;"></div>
                </div>
                <a class="menu" rel="fast_mobile" href="javascript:void(0)" style="float: left;margin-left: 10px;">切换</a>
            </div>
            <div class="s-channel">
                <span class="s-channelName">联通：[ <span id="fast_unicom" style="color:#F50;">{{SmsOperator.SmsFast.ChinaUnicom.ChannelName}}</span> ]</span>
                <div class="progress">
                    <div id="fast_unicom_id" rel="{{SmsOperator.SmsFast.ChinaUnicom.ChannelId}}" class="progress-bar progress-bar-success" role="progressbar" style="width: 0%;cursor:help;"></div>
                </div>
                <a class="menu" rel="fast_unicom" href="javascript:void(0)" style="float: left;margin-left: 10px;">切换</a>
            </div>
            <div class="s-channel">
                <span class="s-channelName">电信：[ <span id="fast_telecom" style="color:#F50;">{{SmsOperator.SmsFast.ChinaTelecom.ChannelName}}</span> ]</span>
                <div class="progress">
                    <div id="fast_telecom_id" rel="{{SmsOperator.SmsFast.ChinaTelecom.ChannelId}}" class="progress-bar progress-bar-success" role="progressbar" style="width: 0%;cursor:help;"></div>
                </div>
                <a class="menu" rel="fast_telecom" href="javascript:void(0)" style="float: left;margin-left: 10px;">切换</a>
            </div>
        </div>
    </div>
    <div class="alert alert-warning status-item">
        <div class="sms-title">
            <strong style="cursor: help;" title="短信群发通道（大于10条）">群发队列</strong>
        </div>
        <div class="s-detail">
            <div class="s-channel">
                <span class="s-channelName">移动：[ <span id="group_mobile" style="color:#F50;">{{SmsOperator.SmsGroup.ChinaMobile.ChannelName}}</span> ]</span>
                <div class="progress">
                    <div id="group_mobile_id" rel="{{SmsOperator.SmsGroup.ChinaMobile.ChannelId}}" class="progress-bar progress-bar-warning" role="progressbar" style="width: 0%;cursor:help;"></div>
                </div>
                <a class="menu" rel="group_mobile" href="javascript:void(0)" style="float: left;margin-left: 10px;">切换</a>
            </div>
            <div class="s-channel">
                <span class="s-channelName">联通：[ <span id="group_unicom" style="color:#F50;">{{SmsOperator.SmsGroup.ChinaUnicom.ChannelName}}</span> ]</span>
                <div class="progress">
                    <div id="group_unicom_id" rel="{{SmsOperator.SmsGroup.ChinaUnicom.ChannelId}}" class="progress-bar progress-bar-warning" role="progressbar" style="width: 0%;cursor:help;"></div>
                </div>
                <a class="menu" rel="group_unicom" href="javascript:void(0)" style="float: left;margin-left: 10px;">切换</a>
            </div>
            <div class="s-channel">
                <span class="s-channelName">电信：[ <span id="group_telecom" style="color:#F50;">{{SmsOperator.SmsGroup.ChinaTelecom.ChannelName}}</span> ]</span>
                <div class="progress">
                    <div id="group_telecom_id" rel="{{SmsOperator.SmsGroup.ChinaTelecom.ChannelId}}" class="progress-bar progress-bar-warning" role="progressbar" style="width: 0%;cursor:help;"></div>
                </div>
                <a class="menu" rel="group_telecom" href="javascript:void(0)" style="float: left;margin-left: 10px;">切换</a>
            </div>
        </div>
    </div>

    <div class="alert alert-warning status-item">
        <div class="sms-title">
            <strong style="cursor: help;" title="短信群发通道（大于10条）">11点回访队列</strong>
        </div>
        <div class="s-detail">
            <div class="s-channel">
                <span class="s-channelName">移动：[ <span id="Return_mobile" style="color:#F50;"></span> ]</span>
                <div class="progress">
                    <div id="Return_mobile_id" rel="" class="progress-bar progress-bar-warning" role="progressbar" style="width: 0%;cursor:help;"></div>
                </div>
                <a class="menu" rel="Return_mobile" href="javascript:void(0)" style="float: left;margin-left: 10px;">切换</a>
            </div>
            <div class="s-channel">
                <span class="s-channelName">联通：[ <span id="Return_unicom" style="color:#F50;"></span> ]</span>
                <div class="progress">
                    <div id="Return_unicom_id" rel="" class="progress-bar progress-bar-warning" role="progressbar" style="width: 0%;cursor:help;"></div>
                </div>
                <a class="menu" rel="Return_unicom" href="javascript:void(0)" style="float: left;margin-left: 10px;">切换</a>
            </div>
            <div class="s-channel">
                <span class="s-channelName">电信：[ <span id="Return_telecom" style="color:#F50;"></span> ]</span>
                <div class="progress">
                    <div id="Return_telecom_id" rel="" class="progress-bar progress-bar-warning" role="progressbar" style="width: 0%;cursor:help;"></div>
                </div>
                <a class="menu" rel="Return_telecom" href="javascript:void(0)" style="float: left;margin-left: 10px;">切换</a>
            </div>
        </div>
    </div>

</script>

<script src="~/Scripts/plugins/artTemplate/template.js"></script>
<script src="~/Scripts/plugins/qtip2/jquery.qtip.min.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        GetChannel();
        setTimeout(GetChannelOption, 1000);

        var sendMode = $("#sendModeVal").val();

        if (sendMode == "1") {

        } else {
            $(".sms-title .menu").each(function () {
                $(this).qtip({
                    content: {
                        text: "当前模式请通过短信服务页面切换通道"
                    }
                });
            });
        }
    });

    function GetChannel() {
        var url = "/sms/GetSmsChannel";
        $.doAjax(url, null, function (data) {
            if (data != "error") {
                var json = $.parseJSON(data);
                var strHtml = template("ChannelSwitchList_Tpl", json);
                $("#ChannelSwitchList").html(strHtml);
            }
        }, false);
    }


    function GetChannelOption() {
        var url = "/sms/GetChannelInfo";
        $.doAjax(url, null, function (data) {
            if (data != "error") {
                var json = $.parseJSON(data);
                if (json.SendMode == 1) {
                    $(".smsChannel").empty().html(template('smsOptionOne-Tpl', json));
                } else {
                    $(".smsChannel").empty().html(template('smsOptionTwo-Tpl', json));
                }

                FirstRun();

                $(".sms-title .menu,.s-detail .menu").each(function () {
                    var type = $(this).attr("rel");
                    $('#ChannelList').attr("rel", type);

                    $(this).qtip({
                        content: {
                            text: $('#ChannelList').clone()
                        },
                        position: {
                            at: 'right center', // Position the tooltip above the link
                            my: 'left center',
                            viewport: $(window), // Keep the tooltip on-screen at all times
                            effect: false // Disable positioning animation
                        },
                        show: {
                            event: 'click',
                            solo: true // Only show one tooltip at a time
                        },
                        hide: {
                            delay: 100,
                            fixed: true
                        },
                        style: {
                            classes: 'qtip-blue qtip-shadow'
                        }
                    });
                });
            }

            GetReturnSmsConfig();
        }, false);

    }

    function ChannelSW(e) {
        $(".sms-title .menu").qtip('toggle', false);

        dialog({
            title: '提示',
            content: '确认切换短信通道',
            zIndex: 20000,
            okValue: '确定',
            ok: function () {
                var type = $(e).parent().parent().parent().parent().attr("rel");
                var value = $(e).attr("rel");
                var sUrl = "/sms/SetChannel";
                if (type.indexOf('Return') > -1) {
                    sUrl = "/sms/SetRevisitChannel";
                }

                var oData = {};
                oData["chname"] = type;
                oData["chid"] = value;

                $.doAjax(sUrl, oData, function (data) {
                    if (data != "error") {
                        if (data == "1") {
                            dialog({
                                content: '短信通道切换成功',
                                quickClose: true
                            }).show();
                            GetChannelOption();
                        } else {
                            dialog({
                                content: '失败,请重新尝试!',
                                quickClose: true
                            }).show();
                        }
                    }
                }, true);
            },
            cancelValue: '取消',
            cancel: function () { }
        }).showModal();
    }

    
    function GetReturnSmsConfig() {
        var url = "/sms/GetRevisitChannel";
        $.doAjax(url, null, function (data) {
            if (data != "error") {
                var jsonStr = $.parseJSON(data);
                $("#Return_mobile").html(jsonStr.SmsOperator.SmsGroup.ChinaMobile.ChannelName);
                $("#Return_mobile_id").attr("rel", jsonStr.SmsOperator.SmsGroup.ChinaMobile.ChannelId);

                $("#Return_unicom").html(jsonStr.SmsOperator.SmsGroup.ChinaUnicom.ChannelName);
                $("#Return_unicom_id").attr("rel", jsonStr.SmsOperator.SmsGroup.ChinaUnicom.ChannelId);

                $("#Return_telecom").html(jsonStr.SmsOperator.SmsGroup.ChinaTelecom.ChannelName);
                $("#Return_telecom_id").attr("rel", jsonStr.SmsOperator.SmsGroup.ChinaTelecom.ChannelId);

                getSmsValue("slow", $("#Return_mobile_id").attr("rel"), "Return_mobile_id");
                getSmsValue("slow", $("#Return_unicom_id").attr("rel"), "Return_unicom_id");
                getSmsValue("slow", $("#Return_telecom_id").attr("rel"), "Return_telecom_id");
            } else {
                dialog({
                    content: '失败,请重新尝试!',
                    quickClose: true
                }).show();
            }
        }, false);
    }











    function FirstRun() {
        var sendMode = $("#smsSendMode").attr("rel");
        if (sendMode == "1") {
            getSmsValue("sys", $("#sys_id").attr("rel"), "sys_id");
            getSmsValue("fast", $("#fast_id").attr("rel"), "fast_id");
            getSmsValue("slow", $("#slow_id").attr("rel"), "slow_id");
        } else {
            getSmsValue("sys", $("#sys_mobile_id").attr("rel"), "sys_mobile_id");
            getSmsValue("sys", $("#sys_unicom_id").attr("rel"), "sys_unicom_id");
            getSmsValue("sys", $("#sys_telecom_id").attr("rel"), "sys_telecom_id");

            getSmsValue("fast", $("#fast_mobile_id").attr("rel"), "fast_mobile_id");
            getSmsValue("fast", $("#fast_unicom_id").attr("rel"), "fast_unicom_id");
            getSmsValue("fast", $("#fast_telecom_id").attr("rel"), "fast_telecom_id");

            getSmsValue("slow", $("#group_mobile_id").attr("rel"), "group_mobile_id");
            getSmsValue("slow", $("#group_unicom_id").attr("rel"), "group_unicom_id");
            getSmsValue("slow", $("#group_telecom_id").attr("rel"), "group_telecom_id");
        }
    }

    function getSmsValue(type, val, option) {
        var url = "/sms/GetChannelBalance?channelid=" + val;
        $.ajax({
            type: "POST",
            url: url,
            success: function (msg) {
                var smsKey = msg;
                var smsCnt = 0;
                var smsWidth = 0;
                if (val == "10" || val == "11" || val == "12") {
                    smsCnt = Math.round((smsKey.substring(0, smsKey.length - 1)) / 0.1);
                }
                else if (val == "21" || val == "22") {
                    smsCnt = parseInt(smsKey.substring(0, smsKey.length - 1));
                }
                else if (val == "41" || val == "42") {
                    smsCnt = Math.round((smsKey.substring(0, smsKey.length - 1)) / 0.1);
                }
                else if (val == "51") {
                    smsCnt = parseInt(smsKey.substring(0, smsKey.length - 1));
                }
                else if (val == "60" || val == "61" || val == "62" || val == "63" || val == "64" || val == "65" || val == "70" || val == "82" || val == "81" || val == "80" || val == "92" || val == "100" || val == "112") {
                    smsCnt = parseInt(smsKey.substring(0, smsKey.length - 1));
                }
                else if (val == "71" || val == "72" || val == "73") {
                    smsCnt = Math.round((smsKey.substring(0, smsKey.length - 1)) / 0.05);
                }
                if (type == "sys") {
                    smsWidth = (parseFloat(smsCnt / 20000).toFixed(2)) * 100;
                    if (smsCnt < 10000) {
                        $("#" + option).removeClass("progress-bar-complete").addClass("progress-bar-danger").addClass("progress-bar-striped").addClass("active");
                    } else {
                        $("#" + option).removeClass("progress-bar-danger").removeClass("progress-bar-striped").removeClass("active").addClass("progress-bar-complete");
                        if (smsCnt > 20000) {
                            smsWidth = 100;
                        }
                    }
                    $("#" + option).html(smsCnt).css("width", smsWidth.toString() + "%").attr("title", "通道余额：" + smsCnt + " 条 （参考标准：2万）");
                } else if (type == "fast") {
                    smsWidth = (parseFloat(smsCnt / 20000).toFixed(2)) * 100;
                    if (smsCnt < 10000) {
                        $("#" + option).removeClass("progress-bar-success").addClass("progress-bar-danger").addClass("progress-bar-striped").addClass("active");
                    } else {
                        $("#" + option).removeClass("progress-bar-danger").removeClass("progress-bar-striped").removeClass("active").addClass("progress-bar-success");
                        if (smsCnt > 20000) {
                            smsWidth = 100;
                        }
                    }
                    $("#" + option).html(smsCnt).css("width", smsWidth.toString() + "%").attr("title", "通道余额：" + smsCnt + " 条 （参考标准：2万）");
                } else if (type == "slow") {
                    smsWidth = (parseFloat(smsCnt / 40000).toFixed(2)) * 100;
                    if (smsCnt < 20000) {
                        $("#" + option).removeClass("progress-bar-warning").addClass("progress-bar-danger").addClass("progress-bar-striped").addClass("active");
                    } else {
                        $("#" + option).removeClass("progress-bar-danger").removeClass("progress-bar-striped").removeClass("active").addClass("progress-bar-warning");
                        if (smsCnt > 40000) {
                            smsWidth = 100;
                        }
                    }
                    $("#" + option).html(smsCnt).css("width", smsWidth.toString() + "%").attr("title", "通道余额：" + smsCnt + " 条 （参考标准：4万）");
                }
            }
        });
    }

    function getChannelInfo(item, val) {
        var oitem = $(item);
        oitem.html("[ 正在加载.. ]");
        var url = "/sms/GetChannelSum?chid=" + val;

        $.doAjax(url, null, function (msg) {
            if (msg != "error") {
                oitem.next().find(".number").html(msg);
                getSmsbalance(val);
                oitem.hide();
                oitem.next().show();
            } else {
                dialog({
                    content: '失败,请重新尝试!',
                    quickClose: true
                }).show();
            }
        }, true);
    }

    function getSmsbalance(val) {
        var url = "/sms/GetChannelBalance?channelid=" + val;
        $.ajax({
            type: "POST",
            url: url,
            success: function (msg) {
                var smsKey = msg;
                var smsCnt = 0;
                if (val == "10" || val == "11" || val == "12") {
                    smsCnt = Math.round((smsKey.substring(0, smsKey.length - 1)) / 0.1);
                }
                else if (val == "21" || val == "22") {
                    smsCnt = parseInt(smsKey.substring(0, smsKey.length - 1));
                }
                else if (val == "41" || val == "42") {
                    smsCnt = Math.round((smsKey.substring(0, smsKey.length - 1)) / 0.1);
                }
                else if (val == "51") {
                    smsCnt = parseInt(smsKey.substring(0, smsKey.length - 1));
                }
                else if (val == "60" || val == "61" || val == "62" || val == "63" || val == "64" || val == "65" || val == "70" || val == "82" || val == "81" || val == "80" || val == "92" || val == "100" || val == "112") {
                    smsCnt = parseInt(smsKey.substring(0, smsKey.length - 1));
                }
                else if (val == "71" || val == "72" || val == "73") {
                    smsCnt = Math.round((smsKey.substring(0, smsKey.length - 1)) / 0.05);
                }
                $("#balance_" + val).html(smsCnt);
            }
        });
    }


</script>